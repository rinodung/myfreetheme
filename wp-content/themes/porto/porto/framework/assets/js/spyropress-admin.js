/* idTabs ~ Sean Catchpole - Version 2.2 - MIT/GPL */
(function(){var dep={"jQuery":"http://code.jquery.com/jquery-latest.min.js"};var init=function(){(function($){$.fn.idTabs=function(){var s={};for(var i=0;i<arguments.length;++i){var a=arguments[i];switch(a.constructor){case Object:$.extend(s,a);break;case Boolean:s.change=a;break;case Number:s.start=a;break;case Function:s.click=a;break;case String:if(a.charAt(0)=='.')s.selected=a;else if(a.charAt(0)=='!')s.event=a;else s.start=a;break;}}
if(typeof s['return']=="function")
s.change=s['return'];return this.each(function(){$.idTabs(this,s);});}
$.idTabs=function(tabs,options){var meta=($.metadata)?$(tabs).metadata():{};var s=$.extend({},$.idTabs.settings,meta,options);if(s.selected.charAt(0)=='.')s.selected=s.selected.substr(1);if(s.event.charAt(0)=='!')s.event=s.event.substr(1);if(s.start==null)s.start=-1;var showId=function(){if($(this).is('.'+s.selected))
return s.change;var id="#"+this.href.split('#')[1];var aList=[];var idList=[];$("a",tabs).each(function(){if(this.href.match(/#/)){aList.push(this);idList.push("#"+this.href.split('#')[1]);}});if(s.click&&!s.click.apply(this,[id,idList,tabs,s]))return s.change;for(i in aList)$(aList[i]).removeClass(s.selected);for(i in idList)$(idList[i]).hide();$(this).addClass(s.selected);$(id).show();return s.change;}
var list=$("a[href*='#']",tabs).unbind(s.event,showId).bind(s.event,showId);list.each(function(){$("#"+this.href.split('#')[1]).hide();});var test=false;if((test=list.filter('.'+s.selected)).length);else if(typeof s.start=="number"&&(test=list.eq(s.start)).length);else if(typeof s.start=="string"&&(test=list.filter("[href*='#"+s.start+"']")).length);if(test){test.removeClass(s.selected);test.trigger(s.event);}
return s;}
$.idTabs.settings={start:0,change:false,click:null,selected:".selected",event:"!click"};$.idTabs.version="2.2";$(function(){$(".idTabs").idTabs();});})(jQuery);}
var check=function(o,s){s=s.split('.');while(o&&s.length)o=o[s.shift()];return o;}
var head=document.getElementsByTagName("head")[0];var add=function(url){var s=document.createElement("script");s.type="text/javascript";s.src=url;head.appendChild(s);}
var s=document.getElementsByTagName('script');var src=s[s.length-1].src;var ok=true;for(d in dep){if(check(this,d))continue;ok=false;add(dep[d]);}if(ok)return init();add(src);})();

/* Color Picker */
(function($){"use strict";$.colorpicker=new function(){this.regional=[];this.regional['']={ok:'OK',cancel:'Cancel',none:'None',button:'Color',title:'Pick a color',transparent:'Transparent',hsvH:'H',hsvS:'S',hsvV:'V',rgbR:'R',rgbG:'G',rgbB:'B',labL:'L',labA:'a',labB:'b',hslH:'H',hslS:'S',hslL:'L',cmykC:'C',cmykM:'M',cmykY:'Y',cmykK:'K',alphaA:'A'};};var _colorpicker_index=0,_container_popup='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',_container_inline='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',_parts_lists={'full':['header','map','bar','hex','hsv','rgb','alpha','lab','cmyk','preview','swatches','footer'],'popup':['map','bar','hex','hsv','rgb','alpha','preview','footer'],'draggable':['header','map','bar','hex','hsv','rgb','alpha','preview','footer'],'inline':['map','bar','hex','hsv','rgb','alpha','preview']},_intToHex=function(dec){var result=Math.round(dec).toString(16);if(result.length===1){result=('0'+result);}
return result.toLowerCase();},_formats={'#HEX':function(color){return _formatColor('#rxgxbx',color);},'#HEX3':function(color){var hex3=_formats.HEX3(color);return hex3===false?false:'#'+hex3;},'HEX':function(color){return _formatColor('rxgxbx',color);},'HEX3':function(color){var rgb=color.getRGB(),r=Math.round(rgb.r*255),g=Math.round(rgb.g*255),b=Math.round(rgb.b*255);if(((r>>>4)==(r&=0xf))&&((g>>>4)==(g&=0xf))&&((b>>>4)==(b&=0xf))){return r.toString(16)+g.toString(16)+b.toString(16);}
return false;},'RGB':function(color){return color.getAlpha()>=1?_formatColor('rgb(rd,gd,bd)',color):false;},'RGBA':function(color){return _formatColor('rgba(rd,gd,bd,af)',color);},'RGB%':function(color){return color.getAlpha()>=1?_formatColor('rgb(rp%,gp%,bp%)',color):false;},'RGBA%':function(color){return _formatColor('rgba(rp%,gp%,bp%,af)',color);},'HSL':function(color){return color.getAlpha()>=1?_formatColor('hsl(hd,sd,vd)',color):false;},'HSLA':function(color){return _formatColor('hsla(hd,sd,vd,af)',color);},'HSL%':function(color){return color.getAlpha()>=1?_formatColor('hsl(hp%,sp%,vp%)',color):false;},'HSLA%':function(color){return _formatColor('hsla(hp%,sp%,vp%,af)',color);},'NAME':function(color){return _closestName(color);},'EXACT':function(color){return _exactName(color);}},_formatColor=function(formats,color){var that=this,text=null,types={'x':function(v){return _intToHex(v*255);},'d':function(v){return Math.round(v*255);},'f':function(v){return v;},'p':function(v){return v*100;}},channels=color.getChannels();if(!$.isArray(formats)){formats=[formats];}
$.each(formats,function(index,format){if(_formats[format]){text=_formats[format](color);return(text===false);}else{text=format.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(m){if(m.match(/^\\/)){return m.slice(1);}
return types[m.charAt(1)](channels[m.charAt(0)]);});return false;}});return text;},_colors={'black':{r:0,g:0,b:0},'dimgray':{r:0.4117647058823529,g:0.4117647058823529,b:0.4117647058823529},'gray':{r:0.5019607843137255,g:0.5019607843137255,b:0.5019607843137255},'darkgray':{r:0.6627450980392157,g:0.6627450980392157,b:0.6627450980392157},'silver':{r:0.7529411764705882,g:0.7529411764705882,b:0.7529411764705882},'lightgrey':{r:0.8274509803921568,g:0.8274509803921568,b:0.8274509803921568},'gainsboro':{r:0.8627450980392157,g:0.8627450980392157,b:0.8627450980392157},'whitesmoke':{r:0.9607843137254902,g:0.9607843137254902,b:0.9607843137254902},'white':{r:1,g:1,b:1},'rosybrown':{r:0.7372549019607844,g:0.5607843137254902,b:0.5607843137254902},'indianred':{r:0.803921568627451,g:0.3607843137254902,b:0.3607843137254902},'brown':{r:0.6470588235294118,g:0.16470588235294117,b:0.16470588235294117},'firebrick':{r:0.6980392156862745,g:0.13333333333333333,b:0.13333333333333333},'lightcoral':{r:0.9411764705882353,g:0.5019607843137255,b:0.5019607843137255},'maroon':{r:0.5019607843137255,g:0,b:0},'darkred':{r:0.5450980392156862,g:0,b:0},'red':{r:1,g:0,b:0},'snow':{r:1,g:0.9803921568627451,b:0.9803921568627451},'salmon':{r:0.9803921568627451,g:0.5019607843137255,b:0.4470588235294118},'mistyrose':{r:1,g:0.8941176470588236,b:0.8823529411764706},'tomato':{r:1,g:0.38823529411764707,b:0.2784313725490196},'darksalmon':{r:0.9137254901960784,g:0.5882352941176471,b:0.47843137254901963},'orangered':{r:1,g:0.27058823529411763,b:0},'coral':{r:1,g:0.4980392156862745,b:0.3137254901960784},'lightsalmon':{r:1,g:0.6274509803921569,b:0.47843137254901963},'sienna':{r:0.6274509803921569,g:0.3215686274509804,b:0.17647058823529413},'seashell':{r:1,g:0.9607843137254902,b:0.9333333333333333},'chocolate':{r:0.8235294117647058,g:0.4117647058823529,b:0.11764705882352941},'saddlebrown':{r:0.5450980392156862,g:0.27058823529411763,b:0.07450980392156863},'sandybrown':{r:0.9568627450980393,g:0.6431372549019608,b:0.3764705882352941},'peachpuff':{r:1,g:0.8549019607843137,b:0.7254901960784313},'peru':{r:0.803921568627451,g:0.5215686274509804,b:0.24705882352941178},'linen':{r:0.9803921568627451,g:0.9411764705882353,b:0.9019607843137255},'darkorange':{r:1,g:0.5490196078431373,b:0},'bisque':{r:1,g:0.8941176470588236,b:0.7686274509803922},'burlywood':{r:0.8705882352941177,g:0.7215686274509804,b:0.5294117647058824},'tan':{r:0.8235294117647058,g:0.7058823529411765,b:0.5490196078431373},'antiquewhite':{r:0.9803921568627451,g:0.9215686274509803,b:0.8431372549019608},'navajowhite':{r:1,g:0.8705882352941177,b:0.6784313725490196},'blanchedalmond':{r:1,g:0.9215686274509803,b:0.803921568627451},'papayawhip':{r:1,g:0.9372549019607843,b:0.8352941176470589},'orange':{r:1,g:0.6470588235294118,b:0},'moccasin':{r:1,g:0.8941176470588236,b:0.7098039215686275},'wheat':{r:0.9607843137254902,g:0.8705882352941177,b:0.7019607843137254},'oldlace':{r:0.9921568627450981,g:0.9607843137254902,b:0.9019607843137255},'floralwhite':{r:1,g:0.9803921568627451,b:0.9411764705882353},'goldenrod':{r:0.8549019607843137,g:0.6470588235294118,b:0.12549019607843137},'darkgoldenrod':{r:0.7215686274509804,g:0.5254901960784314,b:0.043137254901960784},'cornsilk':{r:1,g:0.9725490196078431,b:0.8627450980392157},'gold':{r:1,g:0.8431372549019608,b:0},'palegoldenrod':{r:0.9333333333333333,g:0.9098039215686274,b:0.6666666666666666},'khaki':{r:0.9411764705882353,g:0.9019607843137255,b:0.5490196078431373},'lemonchiffon':{r:1,g:0.9803921568627451,b:0.803921568627451},'darkkhaki':{r:0.7411764705882353,g:0.7176470588235294,b:0.4196078431372549},'beige':{r:0.9607843137254902,g:0.9607843137254902,b:0.8627450980392157},'lightgoldenrodyellow':{r:0.9803921568627451,g:0.9803921568627451,b:0.8235294117647058},'olive':{r:0.5019607843137255,g:0.5019607843137255,b:0},'yellow':{r:1,g:1,b:0},'lightyellow':{r:1,g:1,b:0.8784313725490196},'ivory':{r:1,g:1,b:0.9411764705882353},'olivedrab':{r:0.4196078431372549,g:0.5568627450980392,b:0.13725490196078433},'yellowgreen':{r:0.6039215686274509,g:0.803921568627451,b:0.19607843137254902},'darkolivegreen':{r:0.3333333333333333,g:0.4196078431372549,b:0.1843137254901961},'greenyellow':{r:0.6784313725490196,g:1,b:0.1843137254901961},'lawngreen':{r:0.48627450980392156,g:0.9882352941176471,b:0},'chartreuse':{r:0.4980392156862745,g:1,b:0},'darkseagreen':{r:0.5607843137254902,g:0.7372549019607844,b:0.5607843137254902},'forestgreen':{r:0.13333333333333333,g:0.5450980392156862,b:0.13333333333333333},'limegreen':{r:0.19607843137254902,g:0.803921568627451,b:0.19607843137254902},'lightgreen':{r:0.5647058823529412,g:0.9333333333333333,b:0.5647058823529412},'palegreen':{r:0.596078431372549,g:0.984313725490196,b:0.596078431372549},'darkgreen':{r:0,g:0.39215686274509803,b:0},'green':{r:0,g:0.5019607843137255,b:0},'lime':{r:0,g:1,b:0},'honeydew':{r:0.9411764705882353,g:1,b:0.9411764705882353},'mediumseagreen':{r:0.23529411764705882,g:0.7019607843137254,b:0.44313725490196076},'seagreen':{r:0.1803921568627451,g:0.5450980392156862,b:0.3411764705882353},'springgreen':{r:0,g:1,b:0.4980392156862745},'mintcream':{r:0.9607843137254902,g:1,b:0.9803921568627451},'mediumspringgreen':{r:0,g:0.9803921568627451,b:0.6039215686274509},'mediumaquamarine':{r:0.4,g:0.803921568627451,b:0.6666666666666666},'aquamarine':{r:0.4980392156862745,g:1,b:0.8313725490196079},'turquoise':{r:0.25098039215686274,g:0.8784313725490196,b:0.8156862745098039},'lightseagreen':{r:0.12549019607843137,g:0.6980392156862745,b:0.6666666666666666},'mediumturquoise':{r:0.2823529411764706,g:0.8196078431372549,b:0.8},'darkslategray':{r:0.1843137254901961,g:0.30980392156862746,b:0.30980392156862746},'paleturquoise':{r:0.6862745098039216,g:0.9333333333333333,b:0.9333333333333333},'teal':{r:0,g:0.5019607843137255,b:0.5019607843137255},'darkcyan':{r:0,g:0.5450980392156862,b:0.5450980392156862},'darkturquoise':{r:0,g:0.807843137254902,b:0.8196078431372549},'aqua':{r:0,g:1,b:1},'cyan':{r:0,g:1,b:1},'lightcyan':{r:0.8784313725490196,g:1,b:1},'azure':{r:0.9411764705882353,g:1,b:1},'cadetblue':{r:0.37254901960784315,g:0.6196078431372549,b:0.6274509803921569},'powderblue':{r:0.6901960784313725,g:0.8784313725490196,b:0.9019607843137255},'lightblue':{r:0.6784313725490196,g:0.8470588235294118,b:0.9019607843137255},'deepskyblue':{r:0,g:0.7490196078431373,b:1},'skyblue':{r:0.5294117647058824,g:0.807843137254902,b:0.9215686274509803},'lightskyblue':{r:0.5294117647058824,g:0.807843137254902,b:0.9803921568627451},'steelblue':{r:0.27450980392156865,g:0.5098039215686274,b:0.7058823529411765},'aliceblue':{r:0.9411764705882353,g:0.9725490196078431,b:1},'dodgerblue':{r:0.11764705882352941,g:0.5647058823529412,b:1},'slategray':{r:0.4392156862745098,g:0.5019607843137255,b:0.5647058823529412},'lightslategray':{r:0.4666666666666667,g:0.5333333333333333,b:0.6},'lightsteelblue':{r:0.6901960784313725,g:0.7686274509803922,b:0.8705882352941177},'cornflowerblue':{r:0.39215686274509803,g:0.5843137254901961,b:0.9294117647058824},'royalblue':{r:0.2549019607843137,g:0.4117647058823529,b:0.8823529411764706},'midnightblue':{r:0.09803921568627451,g:0.09803921568627451,b:0.4392156862745098},'lavender':{r:0.9019607843137255,g:0.9019607843137255,b:0.9803921568627451},'navy':{r:0,g:0,b:0.5019607843137255},'darkblue':{r:0,g:0,b:0.5450980392156862},'mediumblue':{r:0,g:0,b:0.803921568627451},'blue':{r:0,g:0,b:1},'ghostwhite':{r:0.9725490196078431,g:0.9725490196078431,b:1},'darkslateblue':{r:0.2823529411764706,g:0.23921568627450981,b:0.5450980392156862},'slateblue':{r:0.41568627450980394,g:0.35294117647058826,b:0.803921568627451},'mediumslateblue':{r:0.4823529411764706,g:0.40784313725490196,b:0.9333333333333333},'mediumpurple':{r:0.5764705882352941,g:0.4392156862745098,b:0.8588235294117647},'blueviolet':{r:0.5411764705882353,g:0.16862745098039217,b:0.8862745098039215},'indigo':{r:0.29411764705882354,g:0,b:0.5098039215686274},'darkorchid':{r:0.6,g:0.19607843137254902,b:0.8},'darkviolet':{r:0.5803921568627451,g:0,b:0.8274509803921568},'mediumorchid':{r:0.7294117647058823,g:0.3333333333333333,b:0.8274509803921568},'thistle':{r:0.8470588235294118,g:0.7490196078431373,b:0.8470588235294118},'plum':{r:0.8666666666666667,g:0.6274509803921569,b:0.8666666666666667},'violet':{r:0.9333333333333333,g:0.5098039215686274,b:0.9333333333333333},'purple':{r:0.5019607843137255,g:0,b:0.5019607843137255},'darkmagenta':{r:0.5450980392156862,g:0,b:0.5450980392156862},'magenta':{r:1,g:0,b:1},'fuchsia':{r:1,g:0,b:1},'orchid':{r:0.8549019607843137,g:0.4392156862745098,b:0.8392156862745098},'mediumvioletred':{r:0.7803921568627451,g:0.08235294117647059,b:0.5215686274509804},'deeppink':{r:1,g:0.0784313725490196,b:0.5764705882352941},'hotpink':{r:1,g:0.4117647058823529,b:0.7058823529411765},'palevioletred':{r:0.8588235294117647,g:0.4392156862745098,b:0.5764705882352941},'lavenderblush':{r:1,g:0.9411764705882353,b:0.9607843137254902},'crimson':{r:0.8627450980392157,g:0.0784313725490196,b:0.23529411764705882},'pink':{r:1,g:0.7529411764705882,b:0.796078431372549},'lightpink':{r:1,g:0.7137254901960784,b:0.7568627450980392}},_exactName=function(color){var name=false;$.each(_colors,function(n,color_b){if(color.equals(new Color(color_b.r,color_b.g,color_b.b))){name=n;return false;}});return name;},_closestName=function(color){var rgb=color.getRGB(),distance=null,name=false,d;$.each(_colors,function(n,color_b){d=color.distance(new Color(color_b.r,color_b.g,color_b.b));if(d<distance||distance===null){name=n;if(d==0){return false;}
distance=d;}});return name;},_parseHex=function(color){var c,m;m=/^#?([a-fA-F0-9]{1,6})$/.exec(color);if(m){c=parseInt(m[1],16);return new Color(((c>>16)&0xFF)/255,((c>>8)&0xFF)/255,(c&0xFF)/255);}
return false;},_parseColor=function(color){var name=$.trim(color).toLowerCase(),m;if(color==''){return new Color();}
if(_colors[name]){return new Color(_colors[name].r,_colors[name].g,_colors[name].b);}
m=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m){return new Color(m[1]/255,m[2]/255,m[3]/255,parseFloat(m[4]));}
m=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m){return(new Color()).setHSL(m[1]/255,m[2]/255,m[3]/255).setAlpha(parseFloat(m[4]));}
m=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m){return new Color(m[1]/100,m[2]/100,m[3]/100,m[4]/100);}
m=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(color);if(m){return(new Color()).setHSL(m[1]/100,m[2]/100,m[3]/100).setAlpha(m[4]/100);}
m=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(color);if(m){return new Color(parseInt(m[1],16)/255,parseInt(m[2],16)/255,parseInt(m[3],16)/255);}
m=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(color);if(m){return new Color(parseInt(m[1]+m[1],16)/255,parseInt(m[2]+m[2],16)/255,parseInt(m[3]+m[3],16)/255);}
return _parseHex(color);},_layoutTable=function(layout,callback){var bitmap,x,y,width,height,columns,rows,index,cell,html,w,h,colspan,walked;layout.sort(function(a,b){if(a.pos[1]==b.pos[1]){return a.pos[0]-b.pos[0];}
return a.pos[1]-b.pos[1];});width=0;height=0;$.each(layout,function(index,part){width=Math.max(width,part.pos[0]+part.pos[2]);height=Math.max(height,part.pos[1]+part.pos[3]);});bitmap=[];for(x=0;x<width;++x){bitmap.push([]);}
rows=[];columns=[];$.each(layout,function(index,part){for(x=0;x<part.pos[2];x+=1){columns[part.pos[0]+x]=true;}
for(y=0;y<part.pos[3];y+=1){rows[part.pos[1]+y]=true;}});html='';cell=layout[index=0];for(y=0;y<height;++y){html+='<tr>';for(x=0;x<width;x){if(typeof cell!=='undefined'&&x==cell.pos[0]&&y==cell.pos[1]){html+=callback(cell,x,y);for(h=0;h<cell.pos[3];h+=1){for(w=0;w<cell.pos[2];w+=1){bitmap[x+w][y+h]=true;}}
x+=cell.pos[2];cell=layout[++index];}else{colspan=0;walked=false;while(x<width&&bitmap[x][y]===undefined&&(cell===undefined||y<cell.pos[1]||(y==cell.pos[1]&&x<cell.pos[0]))){if(columns[x]===true){colspan+=1;}
walked=true;x+=1;}
if(colspan>0){html+='<td colspan="'+colspan+'"></td>';}else if(!walked){x+=1;}}}
html+='</tr>';}
return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+html+'</tbody></table>';},_parts={header:function(inst){var that=this,e=null,_html=function(){var title=inst.options.title||inst._getRegional('title'),html='<span class="ui-dialog-title">'+title+'</span>';if(!inst.inline&&inst.options.showCloseButton){html+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button">'
+'<span class="ui-icon ui-icon-closethick">close</span></a>';}
return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+html+'</div>';};this.init=function(){e=$(_html()).prependTo(inst.dialog);var close=$('.ui-dialog-titlebar-close',e);inst._hoverable(close);inst._focusable(close);close.click(function(event){event.preventDefault();inst.close();});if(!inst.inline&&inst.options.draggable){inst.dialog.draggable({handle:e});}};},map:function(inst){var that=this,e=null,mousemove_timeout=null,_mousedown,_mouseup,_mousemove,_html;_mousedown=function(event){if(!inst.opened){return;}
var div=$('.ui-colorpicker-map-layer-pointer',e),offset=div.offset(),width=div.width(),height=div.height(),x=event.pageX-offset.left,y=event.pageY-offset.top;if(x>=0&&x<width&&y>=0&&y<height){event.stopImmediatePropagation();event.preventDefault();e.unbind('mousedown',_mousedown);$(document).bind('mouseup',_mouseup);$(document).bind('mousemove',_mousemove);_mousemove(event);}};_mouseup=function(event){event.stopImmediatePropagation();event.preventDefault();$(document).unbind('mouseup',_mouseup);$(document).unbind('mousemove',_mousemove);e.bind('mousedown',_mousedown);};_mousemove=function(event){event.stopImmediatePropagation();event.preventDefault();if(event.pageX===that.x&&event.pageY===that.y){return;}
that.x=event.pageX;that.y=event.pageY;var div=$('.ui-colorpicker-map-layer-pointer',e),offset=div.offset(),width=div.width(),height=div.height(),x=event.pageX-offset.left,y=event.pageY-offset.top;x=Math.max(0,Math.min(x/width,1));y=Math.max(0,Math.min(y/height,1));switch(inst.mode){case'h':inst.color.setHSV(null,x,1-y);break;case's':case'a':inst.color.setHSV(x,null,1-y);break;case'v':inst.color.setHSV(x,1-y,null);break;case'r':inst.color.setRGB(null,1-y,x);break;case'g':inst.color.setRGB(1-y,null,x);break;case'b':inst.color.setRGB(x,1-y,null);break;}
inst._change();};_html=function(){var html='<div class="ui-colorpicker-map ui-colorpicker-border">'
+'<span class="ui-colorpicker-map-layer-1">&nbsp;</span>'
+'<span class="ui-colorpicker-map-layer-2">&nbsp;</span>'
+(inst.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':'')
+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return html;};this.update=function(){switch(inst.mode){case'h':$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 0','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).hide();break;case's':case'a':$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 -260px','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).css({'background-position':'0 -520px','opacity':''}).show();break;case'v':$(e).css('background-color','black');$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 -780px','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).hide();break;case'r':$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 -1040px','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).css({'background-position':'0 -1300px','opacity':''}).show();break;case'g':$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 -1560px','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).css({'background-position':'0 -1820px','opacity':''}).show();break;case'b':$('.ui-colorpicker-map-layer-1',e).css({'background-position':'0 -2080px','opacity':''}).show();$('.ui-colorpicker-map-layer-2',e).css({'background-position':'0 -2340px','opacity':''}).show();break;}
that.repaint();};this.repaint=function(){var div=$('.ui-colorpicker-map-layer-pointer',e),x=0,y=0;switch(inst.mode){case'h':x=inst.color.getHSV().s*div.width();y=(1-inst.color.getHSV().v)*div.width();$(e).css('background-color',inst.color.copy().normalize().toCSS());break;case's':case'a':x=inst.color.getHSV().h*div.width();y=(1-inst.color.getHSV().v)*div.width();$('.ui-colorpicker-map-layer-2',e).css('opacity',1-inst.color.getHSV().s);break;case'v':x=inst.color.getHSV().h*div.width();y=(1-inst.color.getHSV().s)*div.width();$('.ui-colorpicker-map-layer-1',e).css('opacity',inst.color.getHSV().v);break;case'r':x=inst.color.getRGB().b*div.width();y=(1-inst.color.getRGB().g)*div.width();$('.ui-colorpicker-map-layer-2',e).css('opacity',inst.color.getRGB().r);break;case'g':x=inst.color.getRGB().b*div.width();y=(1-inst.color.getRGB().r)*div.width();$('.ui-colorpicker-map-layer-2',e).css('opacity',inst.color.getRGB().g);break;case'b':x=inst.color.getRGB().r*div.width();y=(1-inst.color.getRGB().g)*div.width();$('.ui-colorpicker-map-layer-2',e).css('opacity',inst.color.getRGB().b);break;}
if(inst.options.alpha){$('.ui-colorpicker-map-layer-alpha',e).css('opacity',1-inst.color.getAlpha());}
$('.ui-colorpicker-map-pointer',e).css({'left':x-7,'top':y-7});};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-map-container',inst.dialog));e.bind('mousedown',_mousedown);};},bar:function(inst){var that=this,e=null,_mousedown,_mouseup,_mousemove,_html;_mousedown=function(event){if(!inst.opened){return;}
var div=$('.ui-colorpicker-bar-layer-pointer',e),offset=div.offset(),width=div.width(),height=div.height(),x=event.pageX-offset.left,y=event.pageY-offset.top;if(x>=0&&x<width&&y>=0&&y<height){event.stopImmediatePropagation();event.preventDefault();e.unbind('mousedown',_mousedown);$(document).bind('mouseup',_mouseup);$(document).bind('mousemove',_mousemove);_mousemove(event);}};_mouseup=function(event){event.stopImmediatePropagation();event.preventDefault();$(document).unbind('mouseup',_mouseup);$(document).unbind('mousemove',_mousemove);e.bind('mousedown',_mousedown);};_mousemove=function(event){event.stopImmediatePropagation();event.preventDefault();if(event.pageY===that.y){return;}
that.y=event.pageY;var div=$('.ui-colorpicker-bar-layer-pointer',e),offset=div.offset(),height=div.height(),y=event.pageY-offset.top;y=Math.max(0,Math.min(y/height,1));switch(inst.mode){case'h':inst.color.setHSV(1-y,null,null);break;case's':inst.color.setHSV(null,1-y,null);break;case'v':inst.color.setHSV(null,null,1-y);break;case'r':inst.color.setRGB(1-y,null,null);break;case'g':inst.color.setRGB(null,1-y,null);break;case'b':inst.color.setRGB(null,null,1-y);break;case'a':inst.color.setAlpha(1-y);break;}
inst._change();};_html=function(){var html='<div class="ui-colorpicker-bar ui-colorpicker-border">'
+'<span class="ui-colorpicker-bar-layer-1">&nbsp;</span>'
+'<span class="ui-colorpicker-bar-layer-2">&nbsp;</span>'
+'<span class="ui-colorpicker-bar-layer-3">&nbsp;</span>'
+'<span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(inst.options.alpha){html+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span>'
+'<span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>';}
html+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return html;};this.update=function(){switch(inst.mode){case'h':case's':case'v':case'r':case'g':case'b':$('.ui-colorpicker-bar-layer-alpha',e).show();$('.ui-colorpicker-bar-layer-alphabar',e).hide();break;case'a':$('.ui-colorpicker-bar-layer-alpha',e).hide();$('.ui-colorpicker-bar-layer-alphabar',e).show();break;}
switch(inst.mode){case'h':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 0','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).hide();$('.ui-colorpicker-bar-layer-3',e).hide();$('.ui-colorpicker-bar-layer-4',e).hide();break;case's':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 -260px','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).css({'background-position':'0 -520px','opacity':''}).show();$('.ui-colorpicker-bar-layer-3',e).hide();$('.ui-colorpicker-bar-layer-4',e).hide();break;case'v':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 -520px','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).hide();$('.ui-colorpicker-bar-layer-3',e).hide();$('.ui-colorpicker-bar-layer-4',e).hide();break;case'r':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 -1560px','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).css({'background-position':'0 -1300px','opacity':''}).show();$('.ui-colorpicker-bar-layer-3',e).css({'background-position':'0 -780px','opacity':''}).show();$('.ui-colorpicker-bar-layer-4',e).css({'background-position':'0 -1040px','opacity':''}).show();break;case'g':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 -2600px','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).css({'background-position':'0 -2340px','opacity':''}).show();$('.ui-colorpicker-bar-layer-3',e).css({'background-position':'0 -1820px','opacity':''}).show();$('.ui-colorpicker-bar-layer-4',e).css({'background-position':'0 -2080px','opacity':''}).show();break;case'b':$('.ui-colorpicker-bar-layer-1',e).css({'background-position':'0 -3640px','opacity':''}).show();$('.ui-colorpicker-bar-layer-2',e).css({'background-position':'0 -3380px','opacity':''}).show();$('.ui-colorpicker-bar-layer-3',e).css({'background-position':'0 -2860px','opacity':''}).show();$('.ui-colorpicker-bar-layer-4',e).css({'background-position':'0 -3120px','opacity':''}).show();break;case'a':$('.ui-colorpicker-bar-layer-1',e).hide();$('.ui-colorpicker-bar-layer-2',e).hide();$('.ui-colorpicker-bar-layer-3',e).hide();$('.ui-colorpicker-bar-layer-4',e).hide();break;}
that.repaint();};this.repaint=function(){var div=$('.ui-colorpicker-bar-layer-pointer',e),y=0;switch(inst.mode){case'h':y=(1-inst.color.getHSV().h)*div.height();break;case's':y=(1-inst.color.getHSV().s)*div.height();$('.ui-colorpicker-bar-layer-2',e).css('opacity',1-inst.color.getHSV().v);$(e).css('background-color',inst.color.copy().normalize().toCSS());break;case'v':y=(1-inst.color.getHSV().v)*div.height();$(e).css('background-color',inst.color.copy().normalize().toCSS());break;case'r':y=(1-inst.color.getRGB().r)*div.height();$('.ui-colorpicker-bar-layer-2',e).css('opacity',Math.max(0,(inst.color.getRGB().b-inst.color.getRGB().g)));$('.ui-colorpicker-bar-layer-3',e).css('opacity',Math.max(0,(inst.color.getRGB().g-inst.color.getRGB().b)));$('.ui-colorpicker-bar-layer-4',e).css('opacity',Math.min(inst.color.getRGB().b,inst.color.getRGB().g));break;case'g':y=(1-inst.color.getRGB().g)*div.height();$('.ui-colorpicker-bar-layer-2',e).css('opacity',Math.max(0,(inst.color.getRGB().b-inst.color.getRGB().r)));$('.ui-colorpicker-bar-layer-3',e).css('opacity',Math.max(0,(inst.color.getRGB().r-inst.color.getRGB().b)));$('.ui-colorpicker-bar-layer-4',e).css('opacity',Math.min(inst.color.getRGB().r,inst.color.getRGB().b));break;case'b':y=(1-inst.color.getRGB().b)*div.height();$('.ui-colorpicker-bar-layer-2',e).css('opacity',Math.max(0,(inst.color.getRGB().r-inst.color.getRGB().g)));$('.ui-colorpicker-bar-layer-3',e).css('opacity',Math.max(0,(inst.color.getRGB().g-inst.color.getRGB().r)));$('.ui-colorpicker-bar-layer-4',e).css('opacity',Math.min(inst.color.getRGB().r,inst.color.getRGB().g));break;case'a':y=(1-inst.color.getAlpha())*div.height();$(e).css('background-color',inst.color.copy().normalize().toCSS());break;}
if(inst.mode!=='a'){$('.ui-colorpicker-bar-layer-alpha',e).css('opacity',1-inst.color.getAlpha());}
$('.ui-colorpicker-bar-pointer',e).css('top',y-3);};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-bar-container',inst.dialog));e.bind('mousedown',_mousedown);};},preview:function(inst){var that=this,e=null,_html;_html=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border">'
+'<div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div>'
+'<div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div>'
+'</div>';};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-preview-container',inst.dialog));$('.ui-colorpicker-preview-initial',e).click(function(){inst.color=inst.currentColor.copy();inst._change();});};this.update=function(){if(inst.options.alpha){$('.ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha',e).show();}else{$('.ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha',e).hide();}
this.repaint();};this.repaint=function(){$('.ui-colorpicker-preview-initial',e).css('background-color',inst.currentColor.toCSS()).attr('title',inst.currentColor.toHex());$('.ui-colorpicker-preview-initial-alpha',e).css('opacity',1-inst.currentColor.getAlpha());$('.ui-colorpicker-preview-current',e).css('background-color',inst.color.toCSS()).attr('title',inst.color.toHex());$('.ui-colorpicker-preview-current-alpha',e).css('opacity',1-inst.color.getAlpha());};},hsv:function(inst){var that=this,e=null,_html;_html=function(){var html='';if(inst.options.hsv){html+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+inst._getRegional('hsvH')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div>'
+'<div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+inst._getRegional('hsvS')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'
+'<div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+inst._getRegional('hsvV')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>';}
return'<div class="ui-colorpicker-hsv">'+html+'</div>';};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-hsv-container',inst.dialog));$('.ui-colorpicker-mode',e).click(function(){inst.mode=$(this).val();inst._updateAllParts();});$('.ui-colorpicker-number',e).bind('change keyup',function(){inst.color.setHSV($('.ui-colorpicker-hsv-h .ui-colorpicker-number',e).val()/360,$('.ui-colorpicker-hsv-s .ui-colorpicker-number',e).val()/100,$('.ui-colorpicker-hsv-v .ui-colorpicker-number',e).val()/100);inst._change();});};this.repaint=function(){var hsv=inst.color.getHSV();hsv.h*=360;hsv.s*=100;hsv.v*=100;$.each(hsv,function(index,value){var input=$('.ui-colorpicker-hsv-'+index+' .ui-colorpicker-number',e);value=Math.round(value);if(input.val()!==value){input.val(value);}});};this.update=function(){$('.ui-colorpicker-mode',e).each(function(){$(this).attr('checked',$(this).val()===inst.mode);});this.repaint();};},rgb:function(inst){var that=this,e=null,_html;_html=function(){var html='';if(inst.options.rgb){html+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+inst._getRegional('rgbR')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'
+'<div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+inst._getRegional('rgbG')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'
+'<div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+inst._getRegional('rgbB')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>';}
return'<div class="ui-colorpicker-rgb">'+html+'</div>';};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-rgb-container',inst.dialog));$('.ui-colorpicker-mode',e).click(function(){inst.mode=$(this).val();inst._updateAllParts();});$('.ui-colorpicker-number',e).bind('change keyup',function(){inst.color.setRGB($('.ui-colorpicker-rgb-r .ui-colorpicker-number',e).val()/255,$('.ui-colorpicker-rgb-g .ui-colorpicker-number',e).val()/255,$('.ui-colorpicker-rgb-b .ui-colorpicker-number',e).val()/255);inst._change();});};this.repaint=function(){$.each(inst.color.getRGB(),function(index,value){var input=$('.ui-colorpicker-rgb-'+index+' .ui-colorpicker-number',e);value=Math.round(value*255);if(input.val()!==value){input.val(value);}});};this.update=function(){$('.ui-colorpicker-mode',e).each(function(){$(this).attr('checked',$(this).val()===inst.mode);});this.repaint();};},lab:function(inst){var that=this,part=null,html=function(){var html='';if(inst.options.hsv){html+='<div class="ui-colorpicker-lab-l"><label>'+inst._getRegional('labL')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div>'
+'<div class="ui-colorpicker-lab-a"><label>'+inst._getRegional('labA')+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'
+'<div class="ui-colorpicker-lab-b"><label>'+inst._getRegional('labB')+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>';}
return'<div class="ui-colorpicker-lab">'+html+'</div>';};this.init=function(){var data=0;part=$(html()).appendTo($('.ui-colorpicker-lab-container',inst.dialog));$('.ui-colorpicker-number',part).on('change keyup',function(event){inst.color.setLAB(parseInt($('.ui-colorpicker-lab-l .ui-colorpicker-number',part).val(),10)/100,(parseInt($('.ui-colorpicker-lab-a .ui-colorpicker-number',part).val(),10)+128)/255,(parseInt($('.ui-colorpicker-lab-b .ui-colorpicker-number',part).val(),10)+128)/255);inst._change();});};this.repaint=function(){var lab=inst.color.getLAB();lab.l*=100;lab.a=(lab.a*255)-128;lab.b=(lab.b*255)-128;$.each(lab,function(index,value){var input=$('.ui-colorpicker-lab-'+index+' .ui-colorpicker-number',part);value=Math.round(value);if(input.val()!==value){input.val(value);}});};this.update=function(){this.repaint();};},cmyk:function(inst){var that=this,part=null,html=function(){var html='';if(inst.options.hsv){html+='<div class="ui-colorpicker-cmyk-c"><label>'+inst._getRegional('cmykC')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'
+'<div class="ui-colorpicker-cmyk-m"><label>'+inst._getRegional('cmykM')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'
+'<div class="ui-colorpicker-cmyk-y"><label>'+inst._getRegional('cmykY')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'
+'<div class="ui-colorpicker-cmyk-k"><label>'+inst._getRegional('cmykK')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';}
return'<div class="ui-colorpicker-cmyk">'+html+'</div>';};this.init=function(){part=$(html()).appendTo($('.ui-colorpicker-cmyk-container',inst.dialog));$('.ui-colorpicker-number',part).on('change keyup',function(event){inst.color.setCMYK(parseInt($('.ui-colorpicker-cmyk-c .ui-colorpicker-number',part).val(),10)/100,parseInt($('.ui-colorpicker-cmyk-m .ui-colorpicker-number',part).val(),10)/100,parseInt($('.ui-colorpicker-cmyk-y .ui-colorpicker-number',part).val(),10)/100,parseInt($('.ui-colorpicker-cmyk-k .ui-colorpicker-number',part).val(),10)/100);inst._change();});};this.repaint=function(){$.each(inst.color.getCMYK(),function(index,value){var input=$('.ui-colorpicker-cmyk-'+index+' .ui-colorpicker-number',part);value=Math.round(value*100);if(input.val()!==value){input.val(value);}});};this.update=function(){this.repaint();};},alpha:function(inst){var that=this,e=null,_html;_html=function(){var html='';if(inst.options.alpha){html+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+inst._getRegional('alphaA')+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';}
return'<div class="ui-colorpicker-alpha">'+html+'</div>';};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-alpha-container',inst.dialog));$('.ui-colorpicker-mode',e).click(function(){inst.mode=$(this).val();inst._updateAllParts();});$('.ui-colorpicker-number',e).bind('change keyup',function(){inst.color.setAlpha($('.ui-colorpicker-a .ui-colorpicker-number',e).val()/100);inst._change();});};this.update=function(){$('.ui-colorpicker-mode',e).each(function(){$(this).attr('checked',$(this).val()===inst.mode);});this.repaint();};this.repaint=function(){var input=$('.ui-colorpicker-a .ui-colorpicker-number',e),value=Math.round(inst.color.getAlpha()*100);if(!input.is(':focus')&&input.val()!==value){input.val(value);}};},hex:function(inst){var that=this,e=null,_html;_html=function(){var html='';if(inst.options.alpha){html+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>';}
html+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+html+'</div>';};this.init=function(){e=$(_html()).appendTo($('.ui-colorpicker-hex-container',inst.dialog));$('.ui-colorpicker-hex-input',e).bind('change keydown keyup',function(a,b,c){if(/[^a-fA-F0-9]/.test($(this).val())){$(this).val($(this).val().replace(/[^a-fA-F0-9]/,''));}});$('.ui-colorpicker-hex-input',e).bind('change keyup',function(){inst.color=_parseHex($(this).val()).setAlpha(inst.color.getAlpha());inst._change();});$('.ui-colorpicker-hex-alpha',e).bind('change keydown keyup',function(){if(/[^a-fA-F0-9]/.test($(this).val())){$(this).val($(this).val().replace(/[^a-fA-F0-9]/,''));}});$('.ui-colorpicker-hex-alpha',e).bind('change keyup',function(){inst.color.setAlpha(parseInt($('.ui-colorpicker-hex-alpha',e).val(),16)/255);inst._change();});};this.update=function(){this.repaint();};this.repaint=function(){if(!$('.ui-colorpicker-hex-input',e).is(':focus')){$('.ui-colorpicker-hex-input',e).val(inst.color.toHex(true));}
if(!$('.ui-colorpicker-hex-alpha',e).is(':focus')){$('.ui-colorpicker-hex-alpha',e).val(_intToHex(inst.color.getAlpha()*255));}};},swatches:function(inst){var that=this,part=null,html=function(){var html='';$.each(inst.options.swatches,function(name,color){var c=new Color(color.r,color.g,color.b),css=c.toCSS();html+='<div class="ui-colorpicker-swatch" style="background-color: '+css+'" title="'+name+'"></div>';});return'<div class="ui-colorpicker-swatches ui-colorpicker-border">'+html+'</div>';};this.init=function(){part=$(html()).appendTo($('.ui-colorpicker-swatches-container',inst.dialog));$('.ui-colorpicker-swatch',part).click(function(){inst.color=_parseColor($(this).css('background-color'));inst._change();});};},footer:function(inst){var that=this,part=null,id_transparent='ui-colorpicker-special-transparent-'+_colorpicker_index,id_none='ui-colorpicker-special-none-'+_colorpicker_index,html=function(){var html='';if(inst.options.alpha||(!inst.inline&&inst.options.showNoneButton)){html+='<div class="ui-colorpicker-buttonset">';if(inst.options.alpha){html+='<input type="radio" name="ui-colorpicker-special" id="'+id_transparent+'" class="ui-colorpicker-special-transparent"/><label for="'+id_transparent+'">'+inst._getRegional('transparent')+'</label>';}
if(!inst.inline&&inst.options.showNoneButton){html+='<input type="radio" name="ui-colorpicker-special" id="'+id_none+'" class="ui-colorpicker-special-none"><label for="'+id_none+'">'+inst._getRegional('none')+'</label>';}
html+='</div>';}
if(!inst.inline){html+='<div class="ui-dialog-buttonset">';if(inst.options.showCancelButton){html+='<button class="ui-colorpicker-cancel">'+inst._getRegional('cancel')+'</button>';}
html+='<button class="ui-colorpicker-ok">'+inst._getRegional('ok')+'</button>';html+='</div>';}
return'<div class="ui-dialog-buttonpane ui-widget-content">'+html+'</div>';};this.init=function(){part=$(html()).appendTo(inst.dialog);$('.ui-colorpicker-ok',part).button().click(function(){inst.close();});$('.ui-colorpicker-cancel',part).button().click(function(){inst.color=inst.currentColor.copy();inst._change(inst.color.set);inst.close();});$('.ui-colorpicker-buttonset',part).buttonset();$('.ui-colorpicker-special-color',part).click(function(){inst._change();});$('#'+id_none,part).click(function(){inst._change(false);});$('#'+id_transparent,part).click(function(){inst.color.setAlpha(0);inst._change();});};this.repaint=function(){if(!inst.color.set){$('.ui-colorpicker-special-none',part).attr('checked',true).button("refresh");}else if(inst.color.getAlpha()==0){$('.ui-colorpicker-special-transparent',part).attr('checked',true).button("refresh");}else{$('input',part).attr('checked',false).button("refresh");}
$('.ui-colorpicker-cancel',part).button(inst.changed?'enable':'disable');};this.update=function(){};}},Color=function(){var spaces={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},a=1,arg,args=arguments,_clip=function(v){if(isNaN(v)||v===null){return 0;}
if(typeof v=='string'){v=parseInt(v,10);}
return Math.max(0,Math.min(v,1));},_hexify=function(number){var digits='0123456789abcdef',lsd=number%16,msd=(number-lsd)/16,hexified=digits.charAt(msd)+digits.charAt(lsd);return hexified;},_rgb_to_xyz=function(rgb){var r=(rgb.r>0.04045)?Math.pow((rgb.r+0.055)/1.055,2.4):rgb.r/12.92,g=(rgb.g>0.04045)?Math.pow((rgb.g+0.055)/1.055,2.4):rgb.g/12.92,b=(rgb.b>0.04045)?Math.pow((rgb.b+0.055)/1.055,2.4):rgb.b/12.92;return{x:r*0.4124+g*0.3576+b*0.1805,y:r*0.2126+g*0.7152+b*0.0722,z:r*0.0193+g*0.1192+b*0.9505};},_xyz_to_rgb=function(xyz){var rgb={r:xyz.x*3.2406+xyz.y*-1.5372+xyz.z*-0.4986,g:xyz.x*-0.9689+xyz.y*1.8758+xyz.z*0.0415,b:xyz.x*0.0557+xyz.y*-0.2040+xyz.z*1.0570};rgb.r=(rgb.r>0.0031308)?1.055*Math.pow(rgb.r,(1/2.4))-0.055:12.92*rgb.r;rgb.g=(rgb.g>0.0031308)?1.055*Math.pow(rgb.g,(1/2.4))-0.055:12.92*rgb.g;rgb.b=(rgb.b>0.0031308)?1.055*Math.pow(rgb.b,(1/2.4))-0.055:12.92*rgb.b;return rgb;},_rgb_to_hsv=function(rgb){var minVal=Math.min(rgb.r,rgb.g,rgb.b),maxVal=Math.max(rgb.r,rgb.g,rgb.b),delta=maxVal-minVal,del_R,del_G,del_B,hsv={h:0,s:0,v:maxVal};if(delta===0){hsv.h=0;hsv.s=0;}else{hsv.s=delta/maxVal;del_R=(((maxVal-rgb.r)/6)+(delta/2))/delta;del_G=(((maxVal-rgb.g)/6)+(delta/2))/delta;del_B=(((maxVal-rgb.b)/6)+(delta/2))/delta;if(rgb.r===maxVal){hsv.h=del_B-del_G;}else if(rgb.g===maxVal){hsv.h=(1/3)+del_R-del_B;}else if(rgb.b===maxVal){hsv.h=(2/3)+del_G-del_R;}
if(hsv.h<0){hsv.h+=1;}else if(hsv.h>1){hsv.h-=1;}}
return hsv;},_hsv_to_rgb=function(hsv){var rgb={r:0,g:0,b:0},var_h,var_i,var_1,var_2,var_3;if(hsv.s===0){rgb.r=rgb.g=rgb.b=hsv.v;}else{var_h=hsv.h===1?0:hsv.h*6;var_i=Math.floor(var_h);var_1=hsv.v*(1-hsv.s);var_2=hsv.v*(1-hsv.s*(var_h-var_i));var_3=hsv.v*(1-hsv.s*(1-(var_h-var_i)));if(var_i===0){rgb.r=hsv.v;rgb.g=var_3;rgb.b=var_1;}else if(var_i===1){rgb.r=var_2;rgb.g=hsv.v;rgb.b=var_1;}else if(var_i===2){rgb.r=var_1;rgb.g=hsv.v;rgb.b=var_3;}else if(var_i===3){rgb.r=var_1;rgb.g=var_2;rgb.b=hsv.v;}else if(var_i===4){rgb.r=var_3;rgb.g=var_1;rgb.b=hsv.v;}else{rgb.r=hsv.v;rgb.g=var_1;rgb.b=var_2;}}
return rgb;},_rgb_to_hsl=function(rgb){var minVal=Math.min(rgb.r,rgb.g,rgb.b),maxVal=Math.max(rgb.r,rgb.g,rgb.b),delta=maxVal-minVal,del_R,del_G,del_B,hsl={h:0,s:0,l:(maxVal+minVal)/2};if(delta===0){hsl.h=0;hsl.s=0;}else{hsl.s=hsl.l<0.5?delta/(maxVal+minVal):delta/(2-maxVal-minVal);del_R=(((maxVal-rgb.r)/6)+(delta/2))/delta;del_G=(((maxVal-rgb.g)/6)+(delta/2))/delta;del_B=(((maxVal-rgb.b)/6)+(delta/2))/delta;if(rgb.r===maxVal){hsl.h=del_B-del_G;}else if(rgb.g===maxVal){hsl.h=(1/3)+del_R-del_B;}else if(rgb.b===maxVal){hsl.h=(2/3)+del_G-del_R;}
if(hsl.h<0){hsl.h+=1;}else if(hsl.h>1){hsl.h-=1;}}
return hsl;},_hsl_to_rgb=function(hsl){var var_1,var_2,hue_to_rgb=function(v1,v2,vH){if(vH<0){vH+=1;}
if(vH>1){vH-=1;}
if((6*vH)<1){return v1+(v2-v1)*6*vH;}
if((2*vH)<1){return v2;}
if((3*vH)<2){return v1+(v2-v1)*((2/3)-vH)*6;}
return v1;};if(hsl.s===0){return{r:hsl.l,g:hsl.l,b:hsl.l};}
var_2=(hsl.l<0.5)?hsl.l*(1+hsl.s):(hsl.l+hsl.s)-(hsl.s*hsl.l);var_1=2*hsl.l-var_2;return{r:hue_to_rgb(var_1,var_2,hsl.h+(1/3)),g:hue_to_rgb(var_1,var_2,hsl.h),b:hue_to_rgb(var_1,var_2,hsl.h-(1/3))};},_xyz_to_lab=function(xyz){var x=xyz.x/0.95047,y=xyz.y,z=xyz.z/1.08883;x=(x>0.008856)?Math.pow(x,(1/3)):(7.787*x)+(16/116);y=(y>0.008856)?Math.pow(y,(1/3)):(7.787*y)+(16/116);z=(z>0.008856)?Math.pow(z,(1/3)):(7.787*z)+(16/116);return{l:((116*y)-16)/100,a:((500*(x-y))+128)/255,b:((200*(y-z))+128)/255};},_lab_to_xyz=function(lab){var lab2={l:lab.l*100,a:(lab.a*255)-128,b:(lab.b*255)-128},xyz={x:0,y:(lab2.l+16)/116,z:0};xyz.x=lab2.a/500+xyz.y;xyz.z=xyz.y-lab2.b/200;xyz.x=(Math.pow(xyz.x,3)>0.008856)?Math.pow(xyz.x,3):(xyz.x-16/116)/7.787;xyz.y=(Math.pow(xyz.y,3)>0.008856)?Math.pow(xyz.y,3):(xyz.y-16/116)/7.787;xyz.z=(Math.pow(xyz.z,3)>0.008856)?Math.pow(xyz.z,3):(xyz.z-16/116)/7.787;xyz.x*=0.95047;xyz.y*=1;xyz.z*=1.08883;return xyz;},_rgb_to_cmy=function(rgb){return{c:1-(rgb.r),m:1-(rgb.g),y:1-(rgb.b)};},_cmy_to_rgb=function(cmy){return{r:1-(cmy.c),g:1-(cmy.m),b:1-(cmy.y)};},_cmy_to_cmyk=function(cmy){var K=1;if(cmy.c<K){K=cmy.c;}
if(cmy.m<K){K=cmy.m;}
if(cmy.y<K){K=cmy.y;}
if(K==1){return{c:0,m:0,y:0,k:1};}
return{c:(cmy.c-K)/(1-K),m:(cmy.m-K)/(1-K),y:(cmy.y-K)/(1-K),k:K};},_cmyk_to_cmy=function(cmyk){return{c:cmyk.c*(1-cmyk.k)+cmyk.k,m:cmyk.m*(1-cmyk.k)+cmyk.k,y:cmyk.y*(1-cmyk.k)+cmyk.k};};this.set=true;this.setAlpha=function(_a){if(_a!==null){a=_clip(_a);}
return this;};this.getAlpha=function(){return a;};this.setRGB=function(r,g,b){spaces={rgb:this.getRGB()};if(r!==null){spaces.rgb.r=_clip(r);}
if(g!==null){spaces.rgb.g=_clip(g);}
if(b!==null){spaces.rgb.b=_clip(b);}
return this;};this.setHSV=function(h,s,v){spaces={hsv:this.getHSV()};if(h!==null){spaces.hsv.h=_clip(h);}
if(s!==null){spaces.hsv.s=_clip(s);}
if(v!==null){spaces.hsv.v=_clip(v);}
return this;};this.setHSL=function(h,s,l){spaces={hsl:this.getHSL()};if(h!==null){spaces.hsl.h=_clip(h);}
if(s!==null){spaces.hsl.s=_clip(s);}
if(l!==null){spaces.hsl.l=_clip(l);}
return this;};this.setLAB=function(l,a,b){spaces={lab:this.getLAB()};if(l!==null){spaces.lab.l=_clip(l);}
if(a!==null){spaces.lab.a=_clip(a);}
if(b!==null){spaces.lab.b=_clip(b);}
return this;};this.setCMYK=function(c,m,y,k){spaces={cmyk:this.getCMYK()};if(c!==null){spaces.cmyk.c=_clip(c);}
if(m!==null){spaces.cmyk.m=_clip(m);}
if(y!==null){spaces.cmyk.y=_clip(y);}
if(k!==null){spaces.cmyk.k=_clip(k);}
return this;};this.getRGB=function(){if(!spaces.rgb){spaces.rgb=spaces.lab?_xyz_to_rgb(_lab_to_xyz(spaces.lab)):spaces.hsv?_hsv_to_rgb(spaces.hsv):spaces.hsl?_hsl_to_rgb(spaces.hsl):spaces.cmyk?_cmy_to_rgb(_cmyk_to_cmy(spaces.cmyk)):{r:0,g:0,b:0};spaces.rgb.r=_clip(spaces.rgb.r);spaces.rgb.g=_clip(spaces.rgb.g);spaces.rgb.b=_clip(spaces.rgb.b);}
return $.extend({},spaces.rgb);};this.getHSV=function(){if(!spaces.hsv){spaces.hsv=spaces.lab?_rgb_to_hsv(this.getRGB()):spaces.rgb?_rgb_to_hsv(spaces.rgb):spaces.hsl?_rgb_to_hsv(this.getRGB()):spaces.cmyk?_rgb_to_hsv(this.getRGB()):{h:0,s:0,v:0};spaces.hsv.h=_clip(spaces.hsv.h);spaces.hsv.s=_clip(spaces.hsv.s);spaces.hsv.v=_clip(spaces.hsv.v);}
return $.extend({},spaces.hsv);};this.getHSL=function(){if(!spaces.hsl){spaces.hsl=spaces.rgb?_rgb_to_hsl(spaces.rgb):spaces.hsv?_rgb_to_hsl(this.getRGB()):spaces.cmyk?_rgb_to_hsl(this.getRGB()):spaces.hsv?_rgb_to_hsl(this.getRGB()):{h:0,s:0,l:0};spaces.hsl.h=_clip(spaces.hsl.h);spaces.hsl.s=_clip(spaces.hsl.s);spaces.hsl.l=_clip(spaces.hsl.l);}
return $.extend({},spaces.hsl);};this.getCMYK=function(){if(!spaces.cmyk){spaces.cmyk=spaces.rgb?_cmy_to_cmyk(_rgb_to_cmy(spaces.rgb)):spaces.hsv?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):spaces.hsl?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):spaces.lab?_cmy_to_cmyk(_rgb_to_cmy(this.getRGB())):{c:0,m:0,y:0,k:1};spaces.cmyk.c=_clip(spaces.cmyk.c);spaces.cmyk.m=_clip(spaces.cmyk.m);spaces.cmyk.y=_clip(spaces.cmyk.y);spaces.cmyk.k=_clip(spaces.cmyk.k);}
return $.extend({},spaces.cmyk);};this.getLAB=function(){if(!spaces.lab){spaces.lab=spaces.rgb?_xyz_to_lab(_rgb_to_xyz(spaces.rgb)):spaces.hsv?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):spaces.hsl?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):spaces.cmyk?_xyz_to_lab(_rgb_to_xyz(this.getRGB())):{l:0,a:0,b:0};spaces.lab.l=_clip(spaces.lab.l);spaces.lab.a=_clip(spaces.lab.a);spaces.lab.b=_clip(spaces.lab.b);}
return $.extend({},spaces.lab);};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b};};this.distance=function(color){var space='lab',getter='get'+space.toUpperCase(),a=this[getter](),b=color[getter](),distance=0,channel;for(channel in a){distance+=Math.pow(a[channel]-b[channel],2);}
return distance;};this.equals=function(color){var a=this.getRGB(),b=color.getRGB();return this.getAlpha()==color.getAlpha()&&a.r==b.r&&a.g==b.g&&a.b==b.b;};this.limit=function(steps){steps-=1;var rgb=this.getRGB();this.setRGB(Math.round(rgb.r*steps)/steps,Math.round(rgb.g*steps)/steps,Math.round(rgb.b*steps)/steps);};this.toHex=function(){var rgb=this.getRGB();return _hexify(rgb.r*255)+_hexify(rgb.g*255)+_hexify(rgb.b*255);};this.toCSS=function(){return'#'+this.toHex();};this.normalize=function(){this.setHSV(null,1,1);return this;};this.copy=function(){var rgb=this.getRGB(),a=this.getAlpha();return new Color(rgb.r,rgb.g,rgb.b,a);};if(args.length>0){this.setRGB(args[0],args[1],args[2]);this.setAlpha(args[3]===0?0:args[3]||1);}};$.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:'',altOnChange:true,altProperties:'background-color',autoOpen:false,buttonColorize:false,buttonImage:'images/ui-colorpicker.png',buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:'#00FF00',colorFormat:'HEX',draggable:true,duration:'fast',hsv:true,regional:'',layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:'',modal:false,mode:'h',parts:'',rgb:true,showAnim:'fadeIn',showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:'focus',showOptions:{},swatches:null,title:null,close:null,init:null,select:null},_create:function(){var that=this,text;++_colorpicker_index;that.widgetEventPrefix='color';that.opened=false;that.generated=false;that.inline=false;that.changed=false;that.dialog=null;that.button=null;that.image=null;that.overlay=null;that.mode=that.options.mode;if(that.options.swatches===null){that.options.swatches=_colors;}
if(this.element[0].nodeName.toLowerCase()==='input'||!this.inline){that._setColor(that.element.val());this._callback('init');$('body').append(_container_popup);that.dialog=$('.ui-colorpicker:last');$(document).mousedown(function(event){if(!that.opened||event.target===that.element[0]||that.overlay){return;}
if(that.dialog.is(event.target)||that.dialog.has(event.target).length>0){that.element.blur();return;}
var p,parents=$(event.target).parents();for(p=0;p<=parents.length;++p){if(that.button!==null&&parents[p]===that.button[0]){return;}}
if(!that.options.closeOnOutside){return;}
that.close();});$(document).keydown(function(event){if(event.keyCode==27&&that.opened&&that.options.closeOnEscape){that.close();}});if(that.options.showOn==='focus'||that.options.showOn==='both'){that.element.focus(function(){that.open();});}
if(that.options.showOn==='button'||that.options.showOn==='both'){if(that.options.buttonImage!==''){text=that.options.buttonText||that._getRegional('button');that.image=$('<img/>').attr({'src':that.options.buttonImage,'alt':text,'title':text});that._setImageBackground();}
if(that.options.buttonImageOnly&&that.image){that.button=that.image;}else{that.button=$('<button type="button"></button>').html(that.image||that.options.buttonText).button();that.image=that.image?$('img',that.button).first():null;}
that.button.insertAfter(that.element).click(function(){that[that.opened?'close':'open']();});}
if(that.options.autoOpen){that.open();}
that.element.keydown(function(event){if(event.keyCode===9){that.close();}}).keyup(function(event){var color=_parseColor(that.element.val());if(!that.color.equals(color)){that.color=color;that._change();}});}else{that.inline=true;$(this.element).html(_container_inline);that.dialog=$('.ui-colorpicker',this.element);that._generate();that.opened=true;}
return this;},_setOption:function(key,value){var that=this;switch(key){case"disabled":if(value){that.dialog.addClass('ui-colorpicker-disabled');}else{that.dialog.removeClass('ui-colorpicker-disabled');}
break;}
$.Widget.prototype._setOption.apply(that,arguments);},_setImageBackground:function(){if(this.image&&this.options.buttonColorize){this.image.css('background-color',this.color.set?_formatColor('RGBA',this.color):'');}},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var index,property,properties=this.options.altProperties.split(',');for(index=0;index<=properties.length;++index){property=$.trim(properties[index]);switch(property){case'color':case'background-color':case'outline-color':case'border-color':$(this.options.altField).css(property,this.color.set?this.color.toCSS():'');break;}}
if(this.options.altAlpha){$(this.options.altField).css('opacity',this.color.set?this.color.getAlpha():'');}}},_setColor:function(text){this.color=_parseColor(text);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField();},setColor:function(text){this._setColor(text);this._change(this.color.set);},_generate:function(){var that=this,index,part,parts_list,layout_parts;that._setColor(that.inline?that.options.color:that.element.val());if(typeof that.options.parts==='string'){if(_parts_lists[that.options.parts]){parts_list=_parts_lists[that.options.parts];}else{parts_list=_parts_lists[that.inline?'inline':'popup'];}}else{parts_list=that.options.parts;}
that.parts={};$.each(parts_list,function(index,part){if(_parts[part]){that.parts[part]=new _parts[part](that);}});if(!that.generated){layout_parts=[];$.each(that.options.layout,function(part,pos){if(that.parts[part]){layout_parts.push({'part':part,'pos':pos});}});$(_layoutTable(layout_parts,function(cell,x,y){var classes=['ui-colorpicker-'+cell.part+'-container'];if(x>0){classes.push('ui-colorpicker-padding-left');}
if(y>0){classes.push('ui-colorpicker-padding-top');}
return'<td  class="'+classes.join(' ')+'"'
+(cell.pos[2]>1?' colspan="'+cell.pos[2]+'"':'')
+(cell.pos[3]>1?' rowspan="'+cell.pos[3]+'"':'')
+' valign="top"></td>';})).appendTo(that.dialog).addClass('ui-dialog-content ui-widget-content');that._initAllParts();that._updateAllParts();that.generated=true;}},_effectGeneric:function(element,show,slide,fade,callback){var that=this;if($.effects&&$.effects[that.options.showAnim]){element[show](that.options.showAnim,that.options.showOptions,that.options.duration,callback);}else{element[(that.options.showAnim==='slideDown'?slide:(that.options.showAnim==='fadeIn'?fade:show))]((that.options.showAnim?that.options.duration:null),callback);if(!that.options.showAnim||!that.options.duration){callback();}}},_effectShow:function(element,callback){this._effectGeneric(element,'show','slideDown','fadeIn',callback);},_effectHide:function(element,callback){this._effectGeneric(element,'hide','slideUp','fadeOut',callback);},open:function(){var that=this,offset,bottom,right,height,width,x,y,zIndex;if(!that.opened){that._generate();offset=that.element.offset();bottom=$(window).height()+$(window).scrollTop();right=$(window).width()+$(window).scrollLeft();height=that.dialog.outerHeight();width=that.dialog.outerWidth();x=offset.left;y=offset.top+that.element.outerHeight();if(x+width>right){x=Math.max(0,right-width);}
if(y+height>bottom){if(offset.top-height>=$(window).scrollTop()){y=offset.top-height;}else{y=Math.max(0,bottom-height);}}
that.dialog.css({'left':x,'top':y});zIndex=0;$(that.element[0]).parents().each(function(){var z=$(this).css('z-index');if((typeof(z)==='number'||typeof(z)==='string')&&z!==''&&!isNaN(z)){zIndex=z;return false;}});that.dialog.css('z-index',zIndex+=2);that.overlay=that.options.modal?new $.ui.dialog.overlay(that):null;that._effectShow(this.dialog);that.opened=true;$(function(){that._repaintAllParts();});}},close:function(){var that=this;that.currentColor=that.color.copy();that.changed=false;that._effectHide(that.dialog,function(){that.dialog.empty();that.generated=false;that.opened=false;that._callback('close',true);});if(that.overlay){that.overlay.destroy();}},destroy:function(){this.element.unbind();if(this.image!==null){this.image.remove();}
if(this.button!==null){this.button.remove();}
if(this.dialog!==null){this.dialog.remove();}
if(this.overlay){this.overlay.destroy();}},_callback:function(callback,spaces){var that=this,data,lab;if(that.color.set){data={formatted:_formatColor(that.options.colorFormat,that.color)};lab=that.color.getLAB();lab.a=(lab.a*2)-1;lab.b=(lab.b*2)-1;if(spaces===true){data.a=that.color.getAlpha();data.rgb=that.color.getRGB();data.hsv=that.color.getHSV();data.cmyk=that.color.getCMYK();data.hsl=that.color.getHSL();data.lab=lab;}
return that._trigger(callback,null,data);}else{return that._trigger(callback,null,{formatted:''});}},_initAllParts:function(){$.each(this.parts,function(index,part){if(part.init){part.init();}});},_updateAllParts:function(){$.each(this.parts,function(index,part){if(part.update){part.update();}});},_repaintAllParts:function(){$.each(this.parts,function(index,part){if(part.repaint){part.repaint();}});},_change:function(set){this.color.set=(set!==false);this.changed=true;switch(this.options.limit){case'websafe':this.color.limit(6);break;case'nibble':this.color.limit(16);break;case'binary':this.color.limit(2);break;case'name':var name=_closestName(this.color);this.color.setRGB(_colors[name].r,_colors[name].g,_colors[name].b);break;}
if(!this.inline){if(!this.color.set){this.element.val('');}else if(!this.color.equals(_parseColor(this.element.val()))){this.element.val(_formatColor(this.options.colorFormat,this.color));}
this._setImageBackground();this._setAltField();}
if(this.opened){this._repaintAllParts();}
this._callback('select', true);},_hoverable:function(e){e.hover(function(){e.addClass("ui-state-hover");},function(){e.removeClass("ui-state-hover");});},_focusable:function(e){e.focus(function(){e.addClass("ui-state-focus");}).blur(function(){e.removeClass("ui-state-focus");});},_getRegional:function(name){return $.colorpicker.regional[this.options.regional][name]!==undefined?$.colorpicker.regional[this.options.regional][name]:$.colorpicker.regional[''][name];}});}(jQuery));

/* Chosen v1.0.0 | (c) 2011-2013 by Harvest | MIT License, https://github.com/harvesthq/chosen/blob/master/LICENSE.md */
!function(){var a,AbstractChosen,Chosen,SelectParser,b,c={}.hasOwnProperty,d=function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};SelectParser=function(){function SelectParser(){this.options_index=0,this.parsed=[]}return SelectParser.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},SelectParser.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:this.escapeExpression(a.label),children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},SelectParser.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},SelectParser.prototype.escapeExpression=function(a){var b,c;return null==a||a===!1?"":/[\&\<\>\"\'\`]/.test(a)?(b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/&(?!\w+;)|[\<\>\"\'\`]/g,a.replace(c,function(a){return b[a]||"&amp;"})):a},SelectParser}(),SelectParser.select_to_array=function(a){var b,c,d,e,f;for(c=new SelectParser,f=a.childNodes,d=0,e=f.length;e>d;d++)b=f[d],c.add_node(b);return c.parsed},AbstractChosen=function(){function AbstractChosen(a,b){this.form_field=a,this.options=null!=b?b:{},AbstractChosen.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return AbstractChosen.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},AbstractChosen.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text},AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=!0},AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=!1},AbstractChosen.prototype.input_focus=function(){var a=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return a.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},AbstractChosen.prototype.input_blur=function(){var a=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return a.blur_test()},100))},AbstractChosen.prototype.results_option_build=function(a){var b,c,d,e,f;for(b="",f=this.results_data,d=0,e=f.length;e>d;d++)c=f[d],b+=c.group?this.result_add_group(c):this.result_add_option(c),(null!=a?a.first:void 0)&&(c.selected&&this.is_multiple?this.choice_build(c):c.selected&&!this.is_multiple&&this.single_set_selected_text(c.text));return b},AbstractChosen.prototype.result_add_option=function(a){var b,c;return a.search_match?this.include_option_in_results(a)?(b=[],a.disabled||a.selected&&this.is_multiple||b.push("active-result"),!a.disabled||a.selected&&this.is_multiple||b.push("disabled-result"),a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=""!==a.style.cssText?' style="'+a.style+'"':"",'<li class="'+b.join(" ")+'"'+c+' data-option-array-index="'+a.array_index+'">'+a.search_text+"</li>"):"":""},AbstractChosen.prototype.result_add_group=function(a){return a.search_match||a.group_match?a.active_options>0?'<li class="group-result">'+a.search_text+"</li>":"":""},AbstractChosen.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},AbstractChosen.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},AbstractChosen.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},AbstractChosen.prototype.winnow_results=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(this.no_results_clear(),e=0,g=this.get_search_text(),a=g.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),d=this.search_contains?"":"^",c=new RegExp(d+a,"i"),j=new RegExp(a,"i"),m=this.results_data,k=0,l=m.length;l>k;k++)b=m[k],b.search_match=!1,f=null,this.include_option_in_results(b)&&(b.group&&(b.group_match=!1,b.active_options=0),null!=b.group_array_index&&this.results_data[b.group_array_index]&&(f=this.results_data[b.group_array_index],0===f.active_options&&f.search_match&&(e+=1),f.active_options+=1),(!b.group||this.group_search)&&(b.search_text=b.group?b.label:b.html,b.search_match=this.search_string_match(b.search_text,c),b.search_match&&!b.group&&(e+=1),b.search_match?(g.length&&(h=b.search_text.search(j),i=b.search_text.substr(0,h+g.length)+"</em>"+b.search_text.substr(h+g.length),b.search_text=i.substr(0,h)+"<em>"+i.substr(h)),null!=f&&(f.group_match=!0)):null!=b.group_array_index&&this.results_data[b.group_array_index].search_match&&(b.search_match=!0)));return this.result_clear_highlight(),1>e&&g.length?(this.update_results_content(""),this.no_results(g)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},AbstractChosen.prototype.search_string_match=function(a,b){var c,d,e,f;if(b.test(a))return!0;if(this.enable_split_word_search&&(a.indexOf(" ")>=0||0===a.indexOf("["))&&(d=a.replace(/\[|\]/g,"").split(" "),d.length))for(e=0,f=d.length;f>e;e++)if(c=d[e],b.test(c))return!0},AbstractChosen.prototype.choices_count=function(){var a,b,c,d;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,d=this.form_field.options,b=0,c=d.length;c>b;b++)a=d[b],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},AbstractChosen.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},AbstractChosen.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},AbstractChosen.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},AbstractChosen.prototype.include_option_in_results=function(a){return this.is_multiple&&!this.display_selected_options&&a.selected?!1:!this.display_disabled_options&&a.disabled?!1:a.empty?!1:!0},AbstractChosen.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},AbstractChosen.default_multiple_text="Select Some Options",AbstractChosen.default_single_text="Select an Option",AbstractChosen.default_no_result_text="No results match",AbstractChosen}(),a=jQuery,a.fn.extend({chosen:function(b){return AbstractChosen.browser_is_supported()?this.each(function(){var c,d;c=a(this),d=c.data("chosen"),"destroy"===b&&d?d.destroy():d||c.data("chosen",new Chosen(this,b))}):this}}),Chosen=function(c){function Chosen(){return b=Chosen.__super__.constructor.apply(this,arguments)}return d(Chosen,c),Chosen.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},Chosen.prototype.set_up_html=function(){var b,c;return b=["chosen-container"],b.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className),this.is_rtl&&b.push("chosen-rtl"),c={"class":b.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(c.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=a("<div />",c),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},Chosen.prototype.register_observers=function(){var a=this;return this.container.bind("mousedown.chosen",function(b){a.container_mousedown(b)}),this.container.bind("mouseup.chosen",function(b){a.container_mouseup(b)}),this.container.bind("mouseenter.chosen",function(b){a.mouse_enter(b)}),this.container.bind("mouseleave.chosen",function(b){a.mouse_leave(b)}),this.search_results.bind("mouseup.chosen",function(b){a.search_results_mouseup(b)}),this.search_results.bind("mouseover.chosen",function(b){a.search_results_mouseover(b)}),this.search_results.bind("mouseout.chosen",function(b){a.search_results_mouseout(b)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(b){a.search_results_mousewheel(b)}),this.form_field_jq.bind("chosen:updated.chosen",function(b){a.results_update_field(b)}),this.form_field_jq.bind("chosen:activate.chosen",function(b){a.activate_field(b)}),this.form_field_jq.bind("chosen:open.chosen",function(b){a.container_mousedown(b)}),this.search_field.bind("blur.chosen",function(b){a.input_blur(b)}),this.search_field.bind("keyup.chosen",function(b){a.keyup_checker(b)}),this.search_field.bind("keydown.chosen",function(b){a.keydown_checker(b)}),this.search_field.bind("focus.chosen",function(b){a.input_focus(b)}),this.is_multiple?this.search_choices.bind("click.chosen",function(b){a.choices_click(b)}):this.container.bind("click.chosen",function(a){a.preventDefault()})},Chosen.prototype.destroy=function(){return a(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},Chosen.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},Chosen.prototype.container_mousedown=function(b){return this.is_disabled||(b&&"mousedown"===b.type&&!this.results_showing&&b.preventDefault(),null!=b&&a(b.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!b||a(b.target)[0]!==this.selected_item[0]&&!a(b.target).parents("a.chosen-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},Chosen.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},Chosen.prototype.search_results_mousewheel=function(a){var b,c,d;return b=-(null!=(c=a.originalEvent)?c.wheelDelta:void 0)||(null!=(d=a.originialEvent)?d.detail:void 0),null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b=40*b),this.search_results.scrollTop(b+this.search_results.scrollTop())):void 0},Chosen.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},Chosen.prototype.close_field=function(){return a(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},Chosen.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},Chosen.prototype.test_active_click=function(b){return this.container.is(a(b.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},Chosen.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=SelectParser.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},Chosen.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},Chosen.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},Chosen.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},Chosen.prototype.update_results_content=function(a){return this.search_results.html(a)},Chosen.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},Chosen.prototype.set_tab_index=function(){var a;return this.form_field.tabIndex?(a=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=a):void 0},Chosen.prototype.set_label_behavior=function(){var b=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=a("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(a){return b.is_multiple?b.container_mousedown(a):b.activate_field()}):void 0},Chosen.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},Chosen.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b),this.search_field.focus()):void 0},Chosen.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},Chosen.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},Chosen.prototype.choice_build=function(b){var c,d,e=this;return c=a("<li />",{"class":"search-choice"}).html("<span>"+b.html+"</span>"),b.disabled?c.addClass("search-choice-disabled"):(d=a("<a />",{"class":"search-choice-close","data-option-array-index":b.array_index}),d.bind("click.chosen",function(a){return e.choice_destroy_link_click(a)}),c.append(d)),this.search_container.before(c)},Chosen.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),b.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(a(b.target))},Chosen.prototype.choice_destroy=function(a){return this.result_deselect(a[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()):void 0},Chosen.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},Chosen.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},Chosen.prototype.result_select=function(a){var b,c,d;return this.result_highlight?(b=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),d=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[d].selected=!1),this.result_single_selected=b),b.addClass("result-selected"),c=this.results_data[b[0].getAttribute("data-option-array-index")],c.selected=!0,this.form_field.options[c.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(c):this.single_set_selected_text(c.text),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[c.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},Chosen.prototype.single_set_selected_text=function(a){return null==a&&(a=this.default_text),a===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(a)},Chosen.prototype.result_deselect=function(a){var b;return b=this.results_data[a],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value}),this.search_field_scale(),!0)},Chosen.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},Chosen.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html()},Chosen.prototype.winnow_results_set_highlight=function(){var a,b;return b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null!=a?this.result_do_highlight(a):void 0},Chosen.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},Chosen.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(a):void 0:this.results_show()},Chosen.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},Chosen.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},Chosen.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},Chosen.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},Chosen.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return b=a("<div />",{style:f}),b.text(this.search_field.val()),a("body").append(b),h=b.width()+25,b.remove(),c=this.container.outerWidth(),h>c-10&&(h=c-10),this.search_field.css({width:h+"px"})}},Chosen}(AbstractChosen)}.call(this);

/* AJAX Chosen
 * 10 months ago
 * https://github.com/meltingice/ajax-chosen
 */

(function($){return $.fn.ajaxChosen=function(settings,callback,chosenOptions){var chosenXhr,defaultOptions,options,select;if(settings==null){settings={};}
if(chosenOptions==null){chosenOptions={};}
defaultOptions={minTermLength:3,afterTypeDelay:500,jsonTermKey:"term",keepTypingMsg:"Keep typing...",lookingForMsg:"Looking for"};select=this;chosenXhr=null;options=$.extend({},defaultOptions,$(select).data(),settings);this.chosen(chosenOptions?chosenOptions:{});return this.each(function(){return $(this).next('.chosen-container').find(".search-field > input, .chosen-search > input").bind('keyup',function(){var field,msg,success,untrimmed_val,val;untrimmed_val=$(this).val();val=$.trim($(this).val());msg=val.length<options.minTermLength?options.keepTypingMsg:options.lookingForMsg+(" '"+val+"'");select.next('.chosen-container').find('.chosen-results').text(msg);if(val===$(this).data('prevVal')){return false;}
$(this).data('prevVal',val);if(this.timer){clearTimeout(this.timer);}
if(val.length<options.minTermLength){return false;}
field=$(this);if(options.data==null){options.data={};}
options.data[options.jsonTermKey]=val;if(options.dataCallback!=null){options.data=options.dataCallback(options.data);}
success=options.success;options.success=function(data){var items,nbItems,selected_values;if(data==null){return;}
selected_values=[];select.find('option').each(function(){if(!$(this).is(":selected")){return $(this).remove();}else{return selected_values.push($(this).val()+"-"+$(this).text());}});select.find('optgroup:empty').each(function(){return $(this).remove();});items=callback!=null?callback(data,field):data;nbItems=0;$.each(items,function(i,element){var group,text,value;nbItems++;if(element.group){group=select.find("optgroup[label='"+element.text+"']");if(!group.size()){group=$("<optgroup />");}
group.attr('label',element.text).appendTo(select);return $.each(element.items,function(i,element){var text,value;if(typeof element==="string"){value=i;text=element;}else{value=element.value;text=element.text;}
if($.inArray(value+"-"+text,selected_values)===-1){return $("<option />").attr('value',value).html(text).appendTo(group);}});}else{if(typeof element==="string"){value=i;text=element;}else{value=element.value;text=element.text;}
if($.inArray(value+"-"+text,selected_values)===-1){return $("<option />").attr('value',value).html(text).appendTo(select);}}});if(nbItems){select.trigger("chosen:updated");}else{select.data().chosen.no_results_clear();select.data().chosen.no_results(field.val());}
if(settings.success!=null){settings.success(data);}
return field.val(untrimmed_val);};return this.timer=setTimeout(function(){if(chosenXhr){chosenXhr.abort();}
return chosenXhr=$.ajax(options);},options.afterTypeDelay);});});};})(jQuery);

/**
 * Delay
 * Creates a way to delay events
 */
(function ($) {
  $.fn.delay = function(time,func){
    return this.each(function(){
      setTimeout(func,time);
    });
  };
})(jQuery);

/**
 * Center AJAX
 * Creates a way to center the AJAX message
 */
(function ($) {
  $.fn.ajaxMessage = function(html){
    if (html) {
      return $(this).animate({"top":( $(window).height() - $(this).height() ) / 2  - 200 + $(window).scrollTop() + "px"},100).fadeIn('fast').html(html).delay(3000, function(){$('.ajax-message').fadeOut()});
    } else {
      return $(this).animate({"top":( $(window).height() - $(this).height() ) / 2 - 200 + $(window).scrollTop() + "px"},100).fadeIn('fast').delay(3000, function(){$('.ajax-message').fadeOut()});
    }
  };
})(jQuery);


/**************************************/

jQuery(document).ready(function($){
    
    /* Move messages */
    $('ul.spyropress-messages').insertAfter( $('div.wrap h2:first') );
});

if (!('contains' in String.prototype)) {
    String.prototype.contains = function(str, startIndex) {
        return ''.indexOf.call(this, str, startIndex) !== -1;
    };
}